import{Ka as a,N as l,Na as m,g as o,jb as g,s as i,u as n,x as s}from"./chunk-XE4WQH5G.js";var u=class r{http=s(m);platformId=s(l);apiUrl=`${g.apiUrl}/api/auth`;isLoggedInSubject=new o(this.hasToken());isLoggedIn$=this.isLoggedInSubject.asObservable();hasToken(){return a(this.platformId)?!!localStorage.getItem("token"):!1}isBrowser(){return a(this.platformId)}login(t){return this.http.post(`${this.apiUrl}/login`,t).pipe(i(e=>{localStorage.setItem("token",e.token),localStorage.setItem("userName",e.user?.name||""),this.isLoggedInSubject.next(!0),e.token&&(this.saveToken(e.token),e.user?.name?this.saveUserName(e.user.name):e.user?.email&&this.saveUserName(e.user.email))}))}register(t){return this.http.post(`${this.apiUrl}/register`,t).pipe(i(e=>{e.token&&(this.saveToken(e.token),e.user?.name?this.saveUserName(e.user.name):e.user?.email&&this.saveUserName(e.user.email))}))}getCurrentUser(){return this.http.get(`${this.apiUrl}/me`)}logout(){this.isBrowser()&&(localStorage.removeItem("token"),localStorage.removeItem("userName"),this.isLoggedInSubject.next(!1))}saveToken(t){this.isBrowser()&&localStorage.setItem("token",t)}getToken(){return this.isBrowser()?localStorage.getItem("token"):null}isAuthenticated(){return!!this.getToken()}saveUserName(t){this.isBrowser()&&localStorage.setItem("userName",t)}getUserName(){return this.isBrowser()?localStorage.getItem("userName"):null}setSession(t,e){localStorage.setItem("token",t),localStorage.setItem("userName",e),this.isLoggedInSubject.next(!0)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=n({token:r,factory:r.\u0275fac,providedIn:"root"})};export{u as a};
